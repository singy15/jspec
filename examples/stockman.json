{
  "systemName": "stockman",
  "dataType": {
    "number": {},
    "text": {},
    "datetime": {}
  },
  "ioType": {
    "$name": "入出力タイプ",
    "DB": {
      "$name": "データベース"
    },
    "FILE": {},
    "MODEL": {}
  },
  "layoutType": {
    "$name": "レイアウトタイプ",
    "RECTANGLE": {},
    "LINE": {}
  },
  "domainType": {
    "id": {
      "$name": "基本ID型",
      "dbType": "bigint",
      "type": "long",
      "ddlOption": "autoincrement",
      "desc": "標準のID型"
    },
    "stockCd": {
      "name": "在庫CD",
      "type": "string",
      "maxLength": 12,
      "minLength": 12,
      "desc": "YYYYMMDDNNNN\nNNNNは連番",
      "dbType": "varchar(12)"
    },
    "itemCd": {
      "name": "品目CD",
      "type": "string",
      "maxLength": 8,
      "minLength": 8,
      "desc": "NNNNNNNN",
      "dbType": "varchar(8)"
    },
    "longName": {
      "name": "名称",
      "type": "string",
      "dbType": "varchar(max)"
    },
    "stockQty": {
      "name": "在庫数量",
      "type": "long",
      "min": 0,
      "max": 999999999,
      "dbType": "numeric(9)"
    },
    "qty": {
      "name": "数量",
      "type": "long",
      "min": -999999999,
      "max": 999999999,
      "dbType": "numeric(9)"
    },
    "placeCd": {
      "name": "場所CD",
      "type": "long",
      "maxLength": 6,
      "minLength": 6,
      "desc": "XXYYYY\n拠点(XX)+場所(YYYY)",
      "dbType": "varchar(6)"
    }
  },
  "viewComponentType": {
    "form": {
      "$name": "画面",
      "template": "`<div style=\"background-color:#EFEFEF; border:solid 1px ${type.borderColor}; border-radius:5px; width:100%; height:100%;\"><div style=\"top:0px; height:30px; background-color:${type.borderColor}; display:flex; justify-content:start; align-items:center; padding-left:5px; color:#fff;\">${(this.label)? this.label : ''}</div><contents></contents></div>`",
      "borderColor": " #7272c7"
    },
    "button": {
      "$name": "ボタン",
      "template": "`<button style=\"width:100%; height:100%; background-color:#fff; border:solid 1px #888; border-radius:5px;\">${label}</button>`"
    },
    "label": {
      "$name": "ラベル",
      "template": "`<span style=\\\"display:flex; justify-content:${(this.textAlign)? this.textAlign : ''}; align-items:center; width:100%; height:100%; ${(this.style)? this.style : ''} \\\">${(this.label)? this.label : ''}</span>`"
    },
    "radio": {
      "$name": "ラジオボタン",
      "template": "`<label><input type=\"radio\" />${this.label}</label>`"
    },
    "text": {
      "template": "`<input type=\"text\" style=\"width:100%; height:100%; border:solid 1px #888; outline:none; \" v-model=\"${(this.model)? this.model : ''}\" />`",
      "$name": "テキストボックス"
    },
    "date": {
      "$name": "日付",
      "template": "`<input type=\"date\" style=\"width:100%; height:100%;\" value=\"${(this.label)? this.label : ''}\" />`"
    },
    "container": {
      "template": "`<div style=\"width:100%; height:100%; background-color:#fff; border:solid 1px #888; border-radius:5px; ${(this.style)? this.style : ''}\"><div style=\"position:relative\"><contents></contents></div></div>`"
    },
    "group": {
      "template": "`<template v-for=\"(value,index) in ${this.model}\"><div :style=\"{position:'relative', marginTop:'0px', marginLeft:'0px', top:(index * ${this.layout.height}).toString()+'px'}\"><contents></contents></div></template>`",
      "outerTagPositioning": "relative"
    }
  },
  "stock": {
    "$view": {
      "storeStock": {
        "$component": {
          "form": {
            "type": "#viewComponentType.form",
            "layout": {
              "x": 10,
              "y": 35,
              "width": 410,
              "height": 205
            },
            "label": "在庫入庫"
          },
          "labelStockCd": {
            "type": "#viewComponentType.label",
            "layout": {
              "x": 30,
              "y": 85,
              "width": 50,
              "height": 20
            },
            "label": "在庫CD",
            "textAlign": "end"
          },
          "stockCd": {
            "type": "#viewComponentType.text",
            "label": "XXXXXXXXXXXX",
            "layout": {
              "type": "#layoutType.RECTANGLE",
              "x": 90,
              "y": 85,
              "width": 100,
              "height": 20
            }
          },
          "labelItemCd": {
            "type": "#viewComponentType.label",
            "layout": {
              "x": 30,
              "y": 110,
              "width": 50,
              "height": 20
            },
            "label": "品目CD",
            "textAlign": "end"
          },
          "itemCd": {
            "type": "#viewComponentType.text",
            "layout": {
              "x": 90,
              "y": 110,
              "width": 70,
              "height": 20
            },
            "label": "XXXXXXXX"
          },
          "itemName": {
            "type": "#viewComponentType.text",
            "layout": {
              "x": 160,
              "y": 110,
              "width": 230,
              "height": 20
            },
            "label": "ＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮ"
          },
          "labelQty": {
            "type": "#viewComponentType.label",
            "layout": {
              "x": 30,
              "y": 160,
              "width": 50,
              "height": 20
            },
            "label": "入庫数量",
            "textAlign": "end"
          },
          "qty": {
            "type": "#viewComponentType.text",
            "label": "999999999",
            "layout": {
              "type": "#layoutType.RECTANGLE",
              "x": 90,
              "y": 160,
              "width": 70,
              "height": 20
            }
          },
          "register": {
            "type": "#viewComponentType.button",
            "label": "登録",
            "layout": {
              "type": "#layoutType.RECTANGLE",
              "x": 20,
              "y": 205,
              "width": 90,
              "height": 20
            }
          },
          "close": {
            "type": "#viewComponentType.button",
            "label": "閉じる",
            "layout": {
              "type": "#layoutType.RECTANGLE",
              "x": 320,
              "y": 205,
              "width": 90,
              "height": 20
            }
          },
          "placeCd": {
            "type": "#viewComponentType.text",
            "layout": {
              "x": 90,
              "y": 135,
              "width": 55,
              "height": 20
            },
            "label": "XXXXXX"
          },
          "labelPlaceCd": {
            "type": "#viewComponentType.label",
            "layout": {
              "x": 30,
              "y": 135,
              "width": 50,
              "height": 20
            },
            "label": "場所CD",
            "textAlign": "end"
          },
          "detail": {
            "type": "#viewComponentType.container",
            "layout": {
              "x": 20,
              "y": 75,
              "width": 390,
              "height": 120
            }
          }
        }
      },
      "retrieveStock": {
        "$component": {
          "form": {
            "type": "#viewComponentType.form",
            "layout": {
              "x": 10,
              "y": 35,
              "width": 385,
              "height": 180
            },
            "label": "在庫出庫"
          },
          "labelStockCd": {
            "type": "#viewComponentType.label",
            "layout": {
              "x": 15,
              "y": 75,
              "width": 50,
              "height": 20
            },
            "label": "在庫CD",
            "textAlign": "end"
          },
          "stockCd": {
            "type": "#viewComponentType.text",
            "label": "XXXXXXXXXXXX",
            "layout": {
              "type": "#layoutType.RECTANGLE",
              "x": 75,
              "y": 75,
              "width": 100,
              "height": 20
            }
          },
          "labelItemCd": {
            "type": "#viewComponentType.label",
            "layout": {
              "x": 15,
              "y": 100,
              "width": 50,
              "height": 20
            },
            "label": "品目CD",
            "textAlign": "end"
          },
          "itemCd": {
            "type": "#viewComponentType.text",
            "layout": {
              "x": 75,
              "y": 100,
              "width": 70,
              "height": 20
            },
            "label": "XXXXXXXX"
          },
          "itemName": {
            "type": "#viewComponentType.text",
            "layout": {
              "x": 145,
              "y": 100,
              "width": 230,
              "height": 20
            },
            "label": "ＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮ"
          },
          "labelQty": {
            "type": "#viewComponentType.label",
            "layout": {
              "x": 15,
              "y": 150,
              "width": 50,
              "height": 20
            },
            "label": "出庫数量",
            "textAlign": "end"
          },
          "qty": {
            "type": "#viewComponentType.text",
            "label": "999999999",
            "layout": {
              "type": "#layoutType.RECTANGLE",
              "x": 75,
              "y": 150,
              "width": 70,
              "height": 20
            }
          },
          "register": {
            "type": "#viewComponentType.button",
            "label": "登録",
            "layout": {
              "type": "#layoutType.RECTANGLE",
              "x": 20,
              "y": 185,
              "width": 90,
              "height": 20
            }
          },
          "close": {
            "type": "#viewComponentType.button",
            "label": "閉じる",
            "layout": {
              "type": "#layoutType.RECTANGLE",
              "x": 295,
              "y": 185,
              "width": 90,
              "height": 20
            }
          },
          "placeCd": {
            "type": "#viewComponentType.text",
            "layout": {
              "x": 75,
              "y": 125,
              "width": 55,
              "height": 20
            },
            "label": "XXXXXX"
          },
          "labelPlaceCd": {
            "type": "#viewComponentType.label",
            "layout": {
              "x": 15,
              "y": 125,
              "width": 50,
              "height": 20
            },
            "label": "場所CD",
            "textAlign": "end"
          }
        }
      },
      "transferStock": {
        "$component": {
          "form": {
            "type": "#viewComponentType.form",
            "layout": {
              "x": 10,
              "y": 35,
              "width": 420,
              "height": 200
            },
            "label": "在庫移動"
          },
          "labelItemCd": {
            "type": "#viewComponentType.label",
            "layout": {
              "x": 20,
              "y": 75,
              "width": 50,
              "height": 20
            },
            "label": "品目CD",
            "textAlign": "end"
          },
          "itemCd": {
            "type": "#viewComponentType.text",
            "layout": {
              "x": 80,
              "y": 75,
              "width": 70,
              "height": 20
            },
            "label": "XXXXXXXX"
          },
          "itemName": {
            "type": "#viewComponentType.text",
            "layout": {
              "x": 150,
              "y": 75,
              "width": 230,
              "height": 20
            },
            "label": "ＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮ"
          },
          "labelQty": {
            "type": "#viewComponentType.label",
            "layout": {
              "x": 30,
              "y": 170,
              "width": 50,
              "height": 20
            },
            "label": "移動数量",
            "textAlign": "end"
          },
          "qty": {
            "type": "#viewComponentType.text",
            "label": "999999999",
            "layout": {
              "type": "#layoutType.RECTANGLE",
              "x": 90,
              "y": 170,
              "width": 70,
              "height": 20
            }
          },
          "register": {
            "type": "#viewComponentType.button",
            "label": "登録",
            "layout": {
              "type": "#layoutType.RECTANGLE",
              "x": 20,
              "y": 205,
              "width": 90,
              "height": 20
            }
          },
          "close": {
            "type": "#viewComponentType.button",
            "label": "閉じる",
            "layout": {
              "type": "#layoutType.RECTANGLE",
              "x": 330,
              "y": 205,
              "width": 90,
              "height": 20
            }
          },
          "labelFromStockCd": {
            "type": "#viewComponentType.label",
            "layout": {
              "x": 25,
              "y": 110,
              "width": 80,
              "height": 20
            },
            "label": "移動元在庫CD",
            "textAlign": "end"
          },
          "fromStockCd": {
            "type": "#viewComponentType.text",
            "label": "XXXXXXXXXXXX",
            "layout": {
              "type": "#layoutType.RECTANGLE",
              "x": 110,
              "y": 110,
              "width": 100,
              "height": 20
            }
          },
          "labelFromPlaceCd": {
            "type": "#viewComponentType.label",
            "layout": {
              "x": 30,
              "y": 135,
              "width": 75,
              "height": 20
            },
            "label": "移動元場所CD",
            "textAlign": "end"
          },
          "fromPlaceCd": {
            "type": "#viewComponentType.text",
            "layout": {
              "x": 110,
              "y": 135,
              "width": 55,
              "height": 20
            },
            "label": "XXXXXX"
          },
          "toStockCd": {
            "type": "#viewComponentType.text",
            "layout": {
              "x": 315,
              "y": 110,
              "width": 100,
              "height": 20
            },
            "label": "XXXXXXXXXXXX"
          },
          "labelToStockCd": {
            "type": "#viewComponentType.label",
            "layout": {
              "x": 225,
              "y": 110,
              "width": 85,
              "height": 20
            },
            "label": "移動先在庫CD",
            "textAlign": "end"
          },
          "toPlaceCd": {
            "type": "#viewComponentType.text",
            "layout": {
              "x": 315,
              "y": 135,
              "width": 55,
              "height": 20
            },
            "label": "XXXXXX"
          },
          "labelToPlaceCd": {
            "type": "#viewComponentType.label",
            "layout": {
              "x": 230,
              "y": 135,
              "width": 80,
              "height": 20
            },
            "label": "移動先場所CD",
            "textAlign": "end"
          }
        }
      },
      "listStock": {
        "$component": {
          "form": {
            "type": "#viewComponentType.form",
            "layout": {
              "x": 10,
              "y": 35,
              "width": 500,
              "height": 360
            },
            "label": "在庫一覧"
          },
          "stocks": {
            "type": "#viewComponentType.group",
            "layout": {
              "x": 30,
              "y": 130,
              "width": 130,
              "height": 50
            },
            "model": "stocks"
          },
          "labelStockCd": {
            "type": "#viewComponentType.label",
            "layout": {
              "x": 60,
              "y": 80,
              "width": 100,
              "height": 25
            },
            "label": "在庫CD",
            "style": "background-color:#FAFAFA; border:solid 1px #AAA;"
          },
          "detail": {
            "type": "#viewComponentType.container",
            "layout": {
              "x": 30,
              "y": 130,
              "width": 470,
              "height": 185
            },
            "style": "overflow:auto; border-radius:0px; background-color:transparent; border:none;"
          },
          "stockCd": {
            "type": "#viewComponentType.text",
            "layout": {
              "x": 60,
              "y": 130,
              "width": 100,
              "height": 25
            },
            "model": "value.stockCd"
          },
          "itemCd": {
            "type": "#viewComponentType.text",
            "layout": {
              "x": 60,
              "y": 155,
              "width": 100,
              "height": 25
            },
            "model": "value.itemCd"
          },
          "labelItemCd": {
            "type": "#viewComponentType.label",
            "layout": {
              "x": 60,
              "y": 105,
              "width": 100,
              "height": 25
            },
            "label": "品目CD",
            "style": "background-color:#FAFAFA; border:solid 1px #AAA;"
          },
          "labelNo": {
            "type": "#viewComponentType.label",
            "layout": {
              "x": 30,
              "y": 80,
              "width": 30,
              "height": 50
            },
            "label": "No",
            "style": "background-color:#FAFAFA; border:solid 1px #AAA;"
          },
          "no": {
            "type": "#viewComponentType.text",
            "layout": {
              "x": 30,
              "y": 130,
              "width": 30,
              "height": 50
            },
            "model": "index"
          }
        }
      }
    },
    "$process": {
      "registerStock": {
        "$input": {
          "stockTransfer": "#stock.$model.stockTransfer"
        },
        "code": "# 在庫取得\n  在庫CDで在庫レコードを取得する。\n\n  ? 1件取得\n    \n    # 在庫更新\n      //TODO\n\n  ? 0件取得\n\n    # 在庫登録\n      //TODO\n\n# 在庫受払登録\n  在庫受払を登録する。\n  {{stock.$io.stockTransfer.insert}}を入力.stockTransferを引数に実行する。\n\n# メッセージ表示\n  登録完了メッセージをメッセージダイアログで表示する。\n",
        "$output": {
          "result": {
            "type": "#dataType.number"
          }
        }
      }
    },
    "$io": {
      "INSERT_SALE": {
        "type": "#ioType.DB",
        "params$": {
          "MODEL": {
            "type": "#stockDomain.models$.SALE"
          }
        },
        "sql": "INSERT INTO SALE \n(SALE_NO,ISSUE_DATE,DESCRIPTION,AMOUNT) \nVALUES (@MODEL.SALE_NO,@MODEL.ISSUE_DATE,@MODEL.DESCRIPTION,@MODEL.AMOUNT)"
      },
      "DELETE_SALE": {
        "type": "#ioType.DB",
        "params$": {
          "MODEL": {
            "type": "#stockDomain.models$.SALE"
          }
        },
        "sql": "DELETE FROM SALE WHERE SALE_NO = @MODEL.SALE_NO"
      },
      "SELECT_SALE": {
        "type": "#ioType.DB",
        "params$": {
          "MODEL": {
            "type": "#stockDomain.models$.SALE"
          }
        },
        "sql": "SELECT * FROM SALE WHERE SALE_NO = @MODEL.SALE_NO"
      },
      "stockTransfer": {
        "name": "在庫受払入出力",
        "insert": {
          "type": "#ioType.DB",
          "$param": {
            "stockTransfer": {
              "type": "#stock.$model.stockTransfer"
            }
          },
          "sql": "INSERT INTO stock_transfer (stock_id, item_id, qty)\nVALUES ($stockTransfer.stockId, $stockTransfer.itemId, $stockTransfer.qty);"
        }
      }
    },
    "$model": {
      "SALE": {
        "SALE_NO": {
          "type": "#dataType.number"
        },
        "ISSUE_DATE": {
          "type": "#dataType.datetime"
        },
        "DESCRIPTION": {
          "type": "#dataType.text"
        },
        "AMOUNT": {
          "type": "#dataType.number"
        }
      },
      "stockTransfer": {
        "transferId": {
          "type": "#domainType.id"
        },
        "stockId": {
          "type": "#domainType.id"
        },
        "itemId": {
          "type": "#domainType.id"
        },
        "qty": {
          "type": "#domainType.qty"
        }
      }
    }
  },
  "$database": {
    "$table": {
      "stock": {
        "name": "在庫",
        "$column": {
          "stock_id": {
            "type": "#domainType.id",
            "name": "在庫ID"
          },
          "stock_cd": {
            "type": "#domainType.stockCd",
            "name": "在庫CD"
          },
          "place_id": {
            "type": "#domainType.id",
            "name": "場所ID"
          },
          "item_id": {
            "type": "#domainType.id",
            "name": "品目ID"
          },
          "qty": {
            "type": "#domainType.stockQty",
            "name": "在庫数量"
          },
          "reservedQty": {
            "type": "#domainType.stockQty",
            "name": "引当数量"
          }
        }
      },
      "stock_transfer": {
        "name": "在庫受払",
        "$column": {
          "stock_transfer_id": {
            "type": "#domainType.id",
            "name": "受払ID"
          },
          "stock_id": {
            "type": "#domainType.id",
            "name": "在庫ID"
          },
          "item_id": {
            "type": "#domainType.id",
            "name": "品目ID"
          },
          "qty": {
            "type": "#domainType.qty",
            "name": "受払数量"
          }
        }
      },
      "item": {
        "name": "品目",
        "$column": {
          "item_id": {
            "type": "#domainType.id",
            "name": "品目ID"
          },
          "item_cd": {
            "type": "#domainType.itemCd",
            "name": "品目CD"
          },
          "name": {
            "type": "#domainType.longName",
            "name": "商品名"
          }
        }
      },
      "place": {
        "name": "場所",
        "$column": {
          "place_id": {
            "type": "#domainType.id",
            "name": "場所ID"
          },
          "place_cd": {
            "type": "#domainType.placeCd",
            "name": "場所CD"
          },
          "name": {
            "type": "#domainType.longName",
            "name": "場所名"
          }
        }
      }
    }
  },
  "$schema": {
    "$view": {
      "type": "object",
      "properties": {
        "$component": {
          "type": "object",
          "properties": {}
        }
      }
    }
  }
}